{
 "absolute_value": 0,
 "align_labels_right": 0,
 "creation": "2025-05-26 23:44:03.189685",
 "css": " @media print {\r\n      body {\r\n        font-family: 'Courier New', monospace;\r\n        font-size: 12px;\r\n        width: 72mm;\r\n        margin: 0;\r\n        padding: 0;\r\n      }\r\n\r\n      h2, p, h4 {\r\n        margin: 2px 0;\r\n        padding: 0;\r\n          font-size: 10px;\r\n      }\r\n\r\ntable {\r\n  width: 100%;\r\n  border-collapse: collapse;\r\n  font-size: 10px;\r\n}\r\n\r\nth, td {\r\n  text-align: left;\r\n  padding: 2px 0;       /* Reducido */\r\n  line-height: 1.2;     /* M\u00e1s compacto */\r\n}\r\n\r\nth {\r\n  font-weight: bold;\r\n  border-bottom: 1px solid black;\r\n}\r\n\r\n\r\n      .centrado {\r\n        text-align: center;\r\n      }\r\n\r\n      .totales {\r\n        text-align: right;\r\n        font-weight: bold;\r\n        margin-top: 10px;\r\n      }\r\n\r\n      hr {\r\n        border: none;\r\n        border-top: 1px dashed #000;\r\n        margin: 6px 0;\r\n      }\r\n\r\n      .firma {\r\n        text-align: center;\r\n        font-size: 10px;\r\n        margin-top: 20px;\r\n      }\r\n\r\n      .page-break {\r\n        page-break-after: always;\r\n      }\r\n    }\r\n\r\n    body {\r\n      font-family: 'Courier New', monospace;\r\n      font-size: 12px;\r\n      max-width: 72mm;\r\n      margin: auto;\r\n      color: black;\r\n    }",
 "custom_format": 1,
 "default_print_language": "es-EC",
 "disabled": 0,
 "doc_type": "orders",
 "docstatus": 0,
 "doctype": "Print Format",
 "font_size": 14,
 "html": "{# ------------------ NOTA DE VENTA / FACTURA ------------------ #}\r\n\r\n{% macro money(n) %}{{ \"{:,.2f}\".format((n or 0.0) | float) }}{% endmacro %}\r\n\r\n{# Company #}\r\n{% set company = frappe.get_doc(\"Company\", doc.company_id) if doc.get(\"company_id\") else None %}\r\n{% set logo_url = frappe.utils.get_url(company.logo) if company and company.logo else None %}\r\n\r\n{% if logo_url %}\r\n  <div style=\"text-align:center;margin-bottom:10px\">\r\n    <img src=\"{{ logo_url }}\" alt=\"Logo\" style=\"height:80px\">\r\n  </div>\r\n{% endif %}\r\n\r\n{# T\u00edtulo #}\r\n{% set is_factura = (doc.estado == \"Factura\") or (doc.get(\"tipo_comprobante\") == \"1\") %}\r\n<h2 class=\"centrado\">{{ \"FACTURA\" if is_factura else \"NOTA DE VENTA\" }}</h2>\r\n\r\n{# Encabezado factura #}\r\n{% if is_factura and company %}\r\n  <div style=\"font-size:10px;line-height:1.4\">\r\n    <p><strong>RUC Emisor:</strong> {{ company.ruc or 'N/A' }}</p>\r\n    <p><strong>Direcci\u00f3n:</strong> {{ company.address or 'N/A' }}</p>\r\n    {% if doc.estab and doc.ptoemi and doc.secuencial %}\r\n      <p><strong>Factura:</strong> {{ doc.estab }}-{{ doc.ptoemi }}-{{ doc.secuencial }}</p>\r\n    {% endif %}\r\n    {% set access_key = doc.access_key or doc.clave_acceso %}\r\n    {% if access_key %}\r\n      <p><span style=\"word-break:break-word\">{{ access_key }}</span></p>\r\n    {% endif %}\r\n    {% if doc.fecha_autorizacion and doc.fecha_autorizacion not in [\"Nota Venta\",\"N/A\"] %}\r\n      <p><strong>F. Autorizaci\u00f3n:</strong> {{ doc.fecha_autorizacion }}</p>\r\n    {% endif %}\r\n  </div>\r\n{% endif %}\r\n\r\n<div style=\"font-size:10px;line-height:1.4\">\r\n  <p><strong>Fec. Emisi\u00f3n:</strong> {{ frappe.utils.format_datetime(doc.creation, \"dd/MM/yyyy HH:mm\") }}</p>\r\n\r\n  {# Cliente #}\r\n  {% set cli_nombre = frappe.db.get_value(\"Cliente\", doc.customer, \"nombre\") or doc.customer %}\r\n  {% set cli_id    = frappe.db.get_value(\"Cliente\", doc.customer, \"num_identificacion\") or \"\" %}\r\n  {% set cli_mail  = frappe.db.get_value(\"Cliente\", doc.customer, \"correo\") or \"\" %}\r\n  {% set cli_tel   = frappe.db.get_value(\"Cliente\", doc.customer, \"telefono\") or \"\" %}\r\n  {% set cli_dir   = frappe.db.get_value(\"Cliente\", doc.customer, \"direccion\") or \"\" %}\r\n\r\n  <hr>\r\n  <p><strong>Cliente:</strong> {{ cli_nombre }}</p>\r\n  <p><strong>Identificaci\u00f3n:</strong> {{ cli_id }}</p>\r\n  {% if cli_mail %}<p><strong>Correo:</strong> {{ cli_mail }}</p>{% endif %}\r\n  {% if cli_tel %}<p><strong>Tel\u00e9fono:</strong> {{ cli_tel }}</p>{% endif %}\r\n  {% if cli_dir %}<p><strong>Direcci\u00f3n:</strong> {{ cli_dir }}</p>{% endif %}\r\n  {% if doc.alias %}<p class=\"centrado\"><strong>Alias:</strong> {{ doc.alias }}</p>{% endif %}\r\n  <p class=\"centrado\"><strong>Orden:</strong> {{ doc.name }}</p>\r\n</div>\r\n\r\n<hr>\r\n\r\n{# ===================== ACUMULADORES ===================== #}\r\n{% set ns = namespace(\r\n  base0=0.0, base5=0.0, base12=0.0, base13=0.0, base14=0.0, base15=0.0,\r\n  iva0=0.0,  iva5=0.0,  iva12=0.0,  iva13=0.0,  iva14=0.0,  iva15=0.0,\r\n  subtotal=0.0, ivatotal=0.0\r\n) %}\r\n\r\n<table>\r\n  <thead>\r\n    <tr>\r\n      <th>Producto</th>\r\n      <th style=\"text-align:center\">Cant</th>\r\n      <th style=\"text-align:right\">Precio</th>\r\n       <th style=\"text-align:center\">IVA</th>\r\n      <th style=\"text-align:right\">Subtotal</th>\r\n    </tr>\r\n  </thead>\r\n  <tbody>\r\n    {% for item in doc.items %}\r\n      {# % IVA por l\u00ednea: usa item.tax_rate si viene (>0), sino lee de Doctype taxes #}\r\n      {% set tax_rate =\r\n          (item.tax_rate if (item.tax_rate and (item.tax_rate | float) >= 0) else\r\n          (frappe.db.get_value('taxes', item.tax, 'value') or 0)) | float %}\r\n      {% set qty  = (item.qty  or 0) | float %}\r\n      {% set rate = (item.rate or 0) | float %}\r\n      {# Base SIN IVA; ignoramos item.total si viene 0 #}\r\n      {% set base = (qty * rate) | float %}\r\n      {% set iva_line = (base * tax_rate / 100.0) | float %}\r\n\r\n      {# Acumular totales generales #}\r\n      {% set ns.subtotal = ns.subtotal + base %}\r\n      {% set ns.ivatotal = ns.ivatotal + iva_line %}\r\n\r\n      {# Acumular por tasa #}\r\n      {% if (tax_rate | int) == 0 %}\r\n        {% set ns.base0 = ns.base0 + base %}{% set ns.iva0 = ns.iva0 + iva_line %}\r\n      {% elif (tax_rate | int) == 5 %}\r\n        {% set ns.base5 = ns.base5 + base %}{% set ns.iva5 = ns.iva5 + iva_line %}\r\n      {% elif (tax_rate | int) == 12 %}\r\n        {% set ns.base12 = ns.base12 + base %}{% set ns.iva12 = ns.iva12 + iva_line %}\r\n      {% elif (tax_rate | int) == 13 %}\r\n        {% set ns.base13 = ns.base13 + base %}{% set ns.iva13 = ns.iva13 + iva_line %}\r\n      {% elif (tax_rate | int) == 14 %}\r\n        {% set ns.base14 = ns.base14 + base %}{% set ns.iva14 = ns.iva14 + iva_line %}\r\n      {% elif (tax_rate | int) == 15 %}\r\n        {% set ns.base15 = ns.base15 + base %}{% set ns.iva15 = ns.iva15 + iva_line %}\r\n      {% else %}\r\n        {# Si viniera otra tasa rara, la tratamos como 0% por seguridad #}\r\n        {% set ns.base0 = ns.base0 + base %}{% set ns.iva0 = ns.iva0 + 0 %}\r\n      {% endif %}\r\n\r\n      {% set prod_name = frappe.db.get_value(\"Producto\", item.product, \"nombre\") or item.product %}\r\n\r\n      <tr>\r\n        <td>{{ prod_name }}</td>\r\n        <td style=\"text-align:center\">{{ \"{:g}\".format(qty) }}</td>\r\n        <td style=\"text-align:right\">${{ money(rate) }}</td>\r\n                <td style=\"text-align:center\">{{ (tax_rate | int) }}%</td>\r\n        <td style=\"text-align:right\">${{ money(base) }}</td>\r\n      </tr>\r\n    {% endfor %}\r\n  </tbody>\r\n</table>\r\n\r\n<hr>\r\n\r\n{# ========== TOTALES POR TASA ========== #}\r\n{% if ns.base15 > 0 %}\r\n  <p class=\"totales\">Subtotal 15%: ${{ money(ns.base15) }}</p>\r\n  <p class=\"totales\">IVA 15%: ${{ money(ns.iva15) }}</p>\r\n{% endif %}\r\n{% if ns.base14 > 0 %}\r\n  <p class=\"totales\">Subtotal 14%: ${{ money(ns.base14) }}</p>\r\n  <p class=\"totales\">IVA 14%: ${{ money(ns.iva14) }}</p>\r\n{% endif %}\r\n{% if ns.base13 > 0 %}\r\n  <p class=\"totales\">Subtotal 13%: ${{ money(ns.base13) }}</p>\r\n  <p class=\"totales\">IVA 13%: ${{ money(ns.iva13) }}</p>\r\n{% endif %}\r\n{% if ns.base12 > 0 %}\r\n  <p class=\"totales\">Subtotal 12%: ${{ money(ns.base12) }}</p>\r\n  <p class=\"totales\">IVA 12%: ${{ money(ns.iva12) }}</p>\r\n{% endif %}\r\n{% if ns.base5 > 0 %}\r\n  <p class=\"totales\">Subtotal 5%: ${{ money(ns.base5) }}</p>\r\n  <p class=\"totales\">IVA 5%: ${{ money(ns.iva5) }}</p>\r\n{% endif %}\r\n{% if ns.base0 > 0 %}\r\n  <p class=\"totales\">Subtotal 0%: ${{ money(ns.base0) }}</p>\r\n  {# IVA 0% no se muestra porque es 0, pero lo dejamos si quieres:\r\n  <p class=\"totales\">IVA 0%: ${{ money(ns.iva0) }}</p> #}\r\n{% endif %}\r\n\r\n<p class=\"totales\">Subtotal: ${{ money(ns.subtotal) }}</p>\r\n<p class=\"totales\">IVA: ${{ money(ns.ivatotal) }}</p>\r\n<p class=\"totales\"><strong>Total: ${{ money(ns.subtotal + ns.ivatotal) }}</strong></p>\r\n\r\n{# Control opcional contra los montos guardados #}\r\n{# \r\n<p class=\"totales\" style=\"opacity:.6\">[Sistema] Subtotal: ${{ money(doc.subtotal) }}</p>\r\n<p class=\"totales\" style=\"opacity:.6\">[Sistema] IVA: ${{ money(doc.iva) }}</p>\r\n<p class=\"totales\" style=\"opacity:.6\">[Sistema] Total: ${{ money(doc.total) }}</p>\r\n#}\r\n\r\n<div class=\"firma\">Gracias por su compra</div>\r\n",
 "idx": 0,
 "line_breaks": 0,
 "margin_bottom": 15.0,
 "margin_left": 15.0,
 "margin_right": 15.0,
 "margin_top": 15.0,
 "modified": "2025-08-25 14:44:22.549969",
 "modified_by": "Administrator",
 "module": "Restaurante BMARC",
 "name": "Nota de Venta",
 "owner": "Administrator",
 "page_number": "Hide",
 "print_format_builder": 0,
 "print_format_builder_beta": 0,
 "print_format_type": "Jinja",
 "raw_printing": 0,
 "show_section_headings": 0,
 "standard": "Yes"
}